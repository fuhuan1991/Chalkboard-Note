(this.webpackJsonpjs=this.webpackJsonpjs||[]).push([[0],{126:function(e,t,n){e.exports=n(195)},131:function(e,t,n){},133:function(e,t,n){},191:function(e,t,n){},194:function(e,t,n){},195:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(7),i=n.n(o),s=(n(131),n(132),n(50)),c=n(51),l=n(56),u=n(52),m=n(57),d=(n(133),n(36)),p=n(199),h=n(23),f=n(10),v=n(21),g=function(e){if(e.ok)return e;var t=new Error(e.statusText);return t.response=e,e.json().then((function(e){t.error=e})),Promise.reject(t)},E=n(9),y=function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0};function b(e){for(var t=document.cookie.split(";"),n=0;n<t.length;n++){var a=t[n].split("=");if(e===a[0].trim())return decodeURIComponent(a[1])}return null}var N=function(e){return""===e?null:E(e)},S=function(e,t){return e.time>=t.time?1:-1},w={color:"#e2231a",fontSize:"17px"},I={marginBottom:"10px",width:"350px",display:"block"},O=function(e){return r.a.createElement("div",null,r.a.createElement("h1",{className:"big_title"},"Log in"),r.a.createElement(d.a,{initialValues:{name:"",password:""},validate:function(e){var t={};return e.name||(t.name="Name required"),e.password||(t.password="Password required"),t},onSubmit:function(t,n){var a=n.setSubmitting;(function(e){var t=e.name,n=e.password,a="/api/users/login?name=".concat(t,"&password=").concat(n);return Object(v.a)(a,{method:"GET"}).then(g)})(t).then((function(t){e.onSuccess(t)})).catch((function(t){e.onFailure(t),a(!1)}))}},(function(t){var n=t.values,a=t.errors,o=t.touched,i=t.handleChange,s=t.handleBlur,c=t.handleSubmit,l=t.isSubmitting,u=t.submitForm,m=t.isValid;return r.a.createElement("form",{onSubmit:c},r.a.createElement("span",{className:"chalkboard_font"},"name:")," ",a.name&&o.name&&r.a.createElement("span",{style:w},a.name),r.a.createElement(p.a,{style:I,name:"name",onChange:i,onBlur:s,value:n.name,placeholder:"please insert user name"}),r.a.createElement("span",{className:"chalkboard_font"},"password:")," ",a.password&&o.password&&r.a.createElement("span",{style:w},a.password),r.a.createElement(p.a,{style:I,type:"password",name:"password",onChange:i,onBlur:s,value:n.password,placeholder:"please insert password"}),r.a.createElement("div",null,r.a.createElement(h.a,{onClick:function(){return e.OnSitchToSignup()},style:{marginRight:"10px"}},r.a.createElement(f.a,{type:"left"})," Go to Sign up"),r.a.createElement(h.a,{onClick:function(){return u()},type:"primary",disabled:l||y(o)||!m},"Login ",r.a.createElement(f.a,{type:"right"}))))})))},j=n(201),k=function(e,t,n){j.a[e]({message:t,description:n})},C=function(e,t){return k("success",e,t)},x=function(e,t){return k("error",e,t)},T={color:"#e2231a",fontSize:"17px"},_={marginBottom:"10px",width:"350px",display:"block"},A=function(e){return r.a.createElement("div",null,r.a.createElement("h1",{className:"big_title"},"Sign up"),r.a.createElement(d.a,{initialValues:{name:"",password:"",email:""},validate:function(e){var t,n={};return e.name?e.name.length>80&&(n.name="Name should be shorter than 80 characters"):n.name="Name required",e.password?e.password.length>18?n.password="Password should be shorter than 18 characters":e.password.indexOf(" ")>-1&&(n.password="No space is allowed in password"):n.password="Password required",e.email?(t=e.email,/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(t)?e.email.length>100&&(n.email="E-mail should be shorter than 100 characters"):n.email="invalid E-mail address"):n.email="E-mail required",n},onSubmit:function(t,n){var a=n.setSubmitting;(function(e){return Object(v.a)("api/users",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(e)}).then(g)})(t).then((function(){e.onSuccess()})).catch((function(t){e.onFailure(t)})).finally((function(){a(!1)}))}},(function(t){var n=t.values,a=t.errors,o=t.touched,i=t.handleChange,s=t.handleBlur,c=t.handleSubmit,l=t.isSubmitting,u=t.submitForm,m=t.isValid;return r.a.createElement("form",{onSubmit:c},r.a.createElement("span",{className:"chalkboard_font"},"name:")," ",a.name&&o.name&&r.a.createElement("span",{style:T},a.name),r.a.createElement(p.a,{style:_,name:"name",onChange:i,onBlur:s,value:n.name,placeholder:"please insert user name"}),r.a.createElement("span",{className:"chalkboard_font"},"password:")," ",a.password&&o.password&&r.a.createElement("span",{style:T},a.password),r.a.createElement(p.a,{style:_,name:"password",onChange:i,onBlur:s,value:n.password,placeholder:"please insert password"}),r.a.createElement("span",{className:"chalkboard_font"},"email:")," ",a.email&&o.email&&r.a.createElement("span",{style:T},a.email),r.a.createElement(p.a,{style:_,name:"email",onChange:i,onBlur:s,value:n.email,placeholder:"please insert email"}),r.a.createElement("div",null,r.a.createElement(h.a,{onClick:function(){return e.OnSitchToLogin()},style:{marginRight:"10px"}},r.a.createElement(f.a,{type:"left"}),"Go to Login"),r.a.createElement(h.a,{onClick:function(){return u()},type:"submit",disabled:l||y(o)||!m},"Sign up",r.a.createElement(f.a,{type:"right"}))))})))},D=n(60),L=(n(191),n(200)),V=n(25),M=n(123),B=n(196),F={color:"#e2231a",marginLeft:"12px",position:"absolute",left:"27px"},Y=function(e){var t=function(){var t;(t=e.noteId,Object(v.a)("api/notes/".concat(t),{method:"DELETE"}).then(g)).then((function(){e.onCancel(),C("Note Deleted"),e.onDeleteSuccess()})).catch((function(e){x("Error")}))},n=Object(a.useState)(17),o=Object(M.a)(n,2),i=o[0],s=o[1];return r.a.createElement("div",{className:"note_form"},r.a.createElement(d.a,{initialValues:{title:e.title,description:e.description},validate:function(e){var t={};return e.title?e.title.length>280&&(t.title="title should be shorter than 280 characters"):t.title="title required",e.description?e.description.length>11500&&(t.description="description should be shorter than 11500 characters"):t.description="description required",t},onSubmit:function(t,n){var a=n.setSubmitting;e.noteId?function(e){return Object(v.a)("api/notes",{headers:{"Content-Type":"application/json"},method:"PUT",body:JSON.stringify(e)}).then(g)}(Object(V.a)({},t,{userId:e.userId,noteId:e.noteId})).then((function(){e.onSuccess(),a(!1)})).catch((function(t){e.onFailure(t),a(!1)})):function(e){var t=e.userId;return Object(v.a)("api/notes/".concat(t),{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(e)}).then(g)}(Object(V.a)({},t,{userId:e.userId})).then((function(){e.onSuccess(),a(!1)})).catch((function(t){e.onFailure(t),a(!1)}))}},(function(n){var a=n.values,o=n.errors,s=n.touched,c=n.handleChange,l=n.handleBlur,u=n.handleSubmit,m=n.isSubmitting,d=n.submitForm,f=n.isValid;return r.a.createElement("form",{onSubmit:u,className:"inner_form"},r.a.createElement(p.a,{name:"title",onChange:c,onBlur:l,value:a.title,placeholder:"please insert title"}),o.title&&s.title&&r.a.createElement("span",{style:Object(V.a)({},F,{top:"51px"})},o.title),r.a.createElement(p.a.TextArea,{name:"description",onChange:c,onBlur:l,value:a.description,placeholder:"please insert description",style:{fontSize:i+"px"}}),o.description&&s.description&&r.a.createElement("span",{style:Object(V.a)({},F,{top:"658px",width:"300px"})},o.description),r.a.createElement("div",{style:{display:"flex",flexDirection:"row-reverse"}},e.noteId&&r.a.createElement(B.a,{title:"Are you sure\uff1f",okText:"Yes",cancelText:"No",onConfirm:t},r.a.createElement(h.a,{type:"danger",onClick:function(){},style:{marginRight:"10px"}},"Delete")),r.a.createElement(h.a,{onClick:function(){return d()},type:"primary",style:{marginRight:"10px"},disabled:m||y(s)&&!e.noteId||!f},e.noteId?"Update":"Save"),r.a.createElement(h.a,{onClick:function(){return e.onCancel()},style:{marginRight:"10px"}},"Cancel")))})),r.a.createElement(h.a,{onClick:function(){i>10&&s(i-1)},className:"font-btn dec"},"-"),r.a.createElement(h.a,{onClick:function(){s(17)},className:"font-btn reset"},"reset"),r.a.createElement(h.a,{type:"primary",onClick:function(){i<36&&s(i+1)},className:"font-btn inc"},"+"))},G=n(198),P={color:"#e2231a",marginLeft:"12px",position:"absolute",left:"27px"},J=function(e){var t=function(){var t;(t=e.eventId,Object(v.a)("api/events/".concat(t),{method:"DELETE"}).then(g)).then((function(){e.onCancel(),C("Event Deleted"),e.onDeleteSuccess()})).catch((function(e){x("Error")}))};return r.a.createElement("div",{className:"event_form"},r.a.createElement(d.a,{initialValues:{name:e.name,time:e.time,description:e.description},validate:function(e){var t={};return e.name?e.name.length>280&&(t.name="name should be shorter than 280 characters"):t.name="name required",e.description.length>3800&&(t.description="description should be shorter than 3800 characters"),e.time||(t.time="event time required"),t},onSubmit:function(t,n){var a=n.setSubmitting;e.eventId?function(e){return Object(v.a)("api/events",{headers:{"Content-Type":"application/json"},method:"PUT",body:JSON.stringify(e)}).then(g)}(Object(V.a)({},t,{userId:e.userId,eventId:e.eventId})).then((function(){e.onSuccess(),a(!1)})).catch((function(t){e.onFailure(t),a(!1)})):function(e){var t=e.userId;return Object(v.a)("api/events/".concat(t),{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(e)}).then(g)}(Object(V.a)({},t,{userId:e.userId})).then((function(){e.onSuccess(),a(!1)})).catch((function(t){e.onFailure(t),a(!1)}))}},(function(n){var a=n.values,o=n.errors,i=n.touched,s=n.handleChange,c=n.handleBlur,l=n.handleSubmit,u=n.isSubmitting,m=n.submitForm,d=n.isValid,f=n.setFieldValue,v=N(a.time);return r.a.createElement("form",{onSubmit:l,className:"inner_form"},r.a.createElement(p.a,{name:"name",onChange:s,onBlur:c,value:a.name,placeholder:"please insert event name"}),o.name&&i.name&&r.a.createElement("span",{style:Object(V.a)({},P,{top:"51px"})},o.name),r.a.createElement("div",{className:"time_selection"},"Event Time: ",r.a.createElement(G.a,{value:v,showTime:!0,onChange:function(e){var t=function(e){return null===e?"":e.format("YYYY-MM-DD HH:mm:ss")}(e);f("time",t)}})),o.time&&r.a.createElement("span",{style:Object(V.a)({},P,{top:"100px"})},o.time),r.a.createElement(p.a.TextArea,{name:"description",onChange:s,onBlur:c,value:a.description,placeholder:"please insert description"}),o.description&&i.description&&r.a.createElement("span",{style:Object(V.a)({},P,{top:"658px",width:"300px"})},o.description),r.a.createElement("div",{style:{display:"flex",flexDirection:"row-reverse"}},e.eventId&&r.a.createElement(B.a,{title:"Are you sure\uff1f",okText:"Yes",cancelText:"No",onConfirm:t},r.a.createElement(h.a,{type:"danger",onClick:function(){},style:{marginRight:"10px"}},"Delete")),r.a.createElement(h.a,{onClick:function(){return m()},type:"primary",style:{marginRight:"10px"},disabled:u||y(i)&&!e.eventId||!d},e.eventId?"Update":"Save"),r.a.createElement(h.a,{onClick:function(){return e.onCancel()},style:{marginRight:"10px"}},"Cancel")))})))},q=(n(194),n(197)),R=n(9),U=n.n(R),z=function(e){function t(){return Object(s.a)(this,t),Object(l.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=function(e,t){if(!e)return[];var n=E(),a=E().add(t,"days");return e.filter((function(e){var t=e.time,r=E(t);return!(!r.isBefore(a)||!r.isAfter(n))}))}(this.props.eventArray,this.props.range),t=U()(),n=U()().add(this.props.range,"days"),a=86400*this.props.range,o=[],i=t.format("YYYY MMMM DD"),s=n.format("YYYY MMMM DD"),c=!0,l=!1,u=void 0;try{for(var m,d=e[Symbol.iterator]();!(c=(m=d.next()).done);c=!0){var p=m.value,h=N(p.time),f=h.diff(t,"seconds"),v=Math.floor(900*f/a)/10+4;o.push(r.a.createElement(q.a,{content:h.format("YYYY MMMM DD, hh:mm:ss"),title:p.name,trigger:"hover",placement:"bottom",key:p.name},r.a.createElement("div",{className:"point",style:{left:v+"%"}})))}}catch(g){l=!0,u=g}finally{try{c||null==d.return||d.return()}finally{if(l)throw u}}return r.a.createElement("div",{className:"meter"},r.a.createElement("h3",{className:"small_title"},"Incomming events in next 30 days"),r.a.createElement("div",{className:"small_text"},"hover on the markers to see detail"),r.a.createElement("div",{className:"axis"},r.a.createElement(q.a,{content:r.a.createElement("div",null,i),title:"Today",trigger:"hover",placement:"bottom"},r.a.createElement("div",{className:"start_point"})),o,r.a.createElement(q.a,{content:r.a.createElement("div",null,s),title:"30 days later",trigger:"hover",placement:"bottom"},r.a.createElement("div",{className:"end_point"}))))}}]),t}(a.Component),H=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).fetchAllNotes=function(e){(function(e){return Object(v.a)("api/notes/getUserNotes/".concat(e),{method:"GET"}).then(g)})(e).then((function(e){return e.json()})).then((function(e){console.log(e),n.setState({noteArray:e})})).catch((function(e){x("error",e.error.message)}))},n.fetchAllEvents=function(e){(function(e){return Object(v.a)("api/events/getUserEvents/".concat(e),{method:"GET"}).then(g)})(e).then((function(e){return e.json()})).then((function(e){console.log(e),n.setState({eventArray:e})})).catch((function(e){x("error",e.error.message)}))},n.renderNoteArray=function(e){return 0===e.length?r.a.createElement("span",{className:"chalkboard_font empty_msg"},"No Notes"):e.map((function(e){return r.a.createElement("div",{note_id:e.noteId,key:e.noteId,onClick:n.openDetailNoteView.bind(Object(D.a)(n),e.noteId),className:"note_cell"},r.a.createElement("div",{className:"title"},e.title),r.a.createElement("div",{className:"description"},e.description))}))},n.openDetailNoteView=function(e){var t=n.getNoteInfoById(n.state.noteArray,e);t?n.setState({detailNoteView:!0,targetNote:t}):console.log("can not get note with id "+e)},n.openDetailEventView=function(e){var t=n.getEventInfoById(n.state.eventArray,e);t?n.setState({detailEventView:!0,targetEvent:t}):console.log("can not get event with id "+e)},n.getNoteInfoById=function(e,t){var n=e.filter((function(e){return e.noteId===t}));return n.length>0?n[0]:null},n.getEventInfoById=function(e,t){var n=e.filter((function(e){return e.eventId===t}));return n.length>0?n[0]:null},n.onAddNewNote=function(){n.setState({target:null,targetNote:null,detailNoteView:!0})},n.onAddNewEvent=function(){n.setState({target:null,targetEvent:null,detailEventView:!0})},n.renderEventArray=function(e){return 0===e.length?r.a.createElement("span",{className:"chalkboard_font empty_msg"},"No Events"):(e.sort(S),e.map((function(e){return r.a.createElement("div",{event_id:e.eventId,key:e.eventId,onClick:n.openDetailEventView.bind(Object(D.a)(n),e.eventId),className:"event_cell"},r.a.createElement("div",{className:"name"},e.name),r.a.createElement("div",null,e.time))})))},n.state={noteArray:[],eventArray:[],detailNoteView:!1,detailEventView:!1,targetNote:null,targetEvent:null},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.fetchAllNotes(this.props.userId),this.fetchAllEvents(this.props.userId)}},{key:"render",value:function(){var e=this,t=this.renderNoteArray(this.state.noteArray),n=this.renderEventArray(this.state.eventArray),a=b("user_name");return r.a.createElement("div",{className:"desktop"},r.a.createElement("h1",{className:"big_title"},"Hello, ",a),r.a.createElement(h.a,{type:"primary",onClick:function(){return e.props.onLogout()}},r.a.createElement(f.a,{type:"left"}),"log out"),r.a.createElement("h1",{className:"big_title"},"Notes"),r.a.createElement(h.a,{type:"primary",onClick:function(){return e.onAddNewNote()}},r.a.createElement(f.a,{type:"plus-circle"}),"Add New Note"),r.a.createElement("div",{className:"note_container"},t),r.a.createElement("h1",{className:"big_title"},"Events"),r.a.createElement(h.a,{type:"primary",onClick:function(){return e.onAddNewEvent()}},r.a.createElement(f.a,{type:"plus-circle"}),"Add New Event"),r.a.createElement(z,{eventArray:this.state.eventArray,range:30}),r.a.createElement("div",{className:"note_container"},n),r.a.createElement(L.a,{visible:this.state.detailNoteView,footer:null,closable:!1,width:600,wrapClassName:"note_modal"},r.a.createElement(Y,{key:Math.random(),title:this.state.targetNote?this.state.targetNote.title:"",description:this.state.targetNote?this.state.targetNote.description:"",userId:this.props.userId,noteId:this.state.targetNote?this.state.targetNote.noteId:"",onSuccess:function(){e.fetchAllNotes(e.props.userId),C("Note updated"),e.setState({detailNoteView:!1,targetNote:null})},onFailure:function(e){x("Error")},onDeleteSuccess:function(){e.fetchAllNotes(e.props.userId),e.setState({detailNoteView:!1,targetNote:null})},onCancel:function(){e.setState({detailNoteView:!1,targetNote:null})}})),r.a.createElement(L.a,{visible:this.state.detailEventView,footer:null,closable:!1,width:600,wrapClassName:"event_modal"},r.a.createElement(J,{key:Math.random(),name:this.state.targetEvent?this.state.targetEvent.name:"",time:this.state.targetEvent?this.state.targetEvent.time:"",description:this.state.targetEvent?this.state.targetEvent.description:"",userId:this.props.userId,eventId:this.state.targetEvent?this.state.targetEvent.eventId:"",onSuccess:function(){e.fetchAllEvents(e.props.userId),C("Event updated"),e.setState({detailEventView:!1,targetEvent:null})},onFailure:function(e){x("Error")},onDeleteSuccess:function(){e.fetchAllEvents(e.props.userId),e.setState({detailEventView:!1,targetEvent:null})},onCancel:function(){e.setState({detailEventView:!1,targetEvent:null})}})))}}]),t}(a.Component),K=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e))).onLoginSucc=function(e){e.json().then((function(e){document.cookie="jwt_token=".concat(e.jwt),document.cookie="user_name=".concat(e.name),document.cookie="user_id=".concat(e.userId),n.setState({userId:e.userId}),C("Login successful","Welcom back"+e.name),n.switchToStage("DESKTOP")()})).catch((function(){x("Login failed","invalid user")}))},n.onLoginFail=function(e){x("Login failed",e.error.message)},n.onSignupSucc=function(){C("Sign up successful","Please log in"),n.switchToStage("LOGIN")()},n.onSignupFail=function(e){console.log(e,e.error),x("Sign up failed",e.error.message)},n.switchToStage=function(e){return function(){n.setState({currentStage:e})}},n.onLogout=function(){document.cookie="jwt_token= ; expires = Thu, 01 Jan 1970 00:00:00 GMT",document.cookie="user_name= ; expires = Thu, 01 Jan 1970 00:00:00 GMT",document.cookie="user_id= ; expires = Thu, 01 Jan 1970 00:00:00 GMT",n.setState({currentStage:"LOGIN",userId:""})},n.state={currentStage:"LOGIN",userId:""},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this,t=b("jwt_token"),n=b("user_name"),a=b("user_id");t&&n&&a&&function(e,t){return Object(v.a)("api/users/check?name=".concat(e,"&jwt=").concat(t),{headers:{"Content-Type":"application/json"},method:"GET"}).then(g)}(n,t).then((function(){e.setState({userId:a}),C("Login successful","Welcom back "+n),e.switchToStage("DESKTOP")()})).catch((function(t){e.onLogout()}))}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"note_management"},"LOGIN"===this.state.currentStage&&r.a.createElement(O,{onSuccess:this.onLoginSucc,onFailure:this.onLoginFail,OnSitchToSignup:this.switchToStage("SIGNUP")}),"SIGNUP"===this.state.currentStage&&r.a.createElement(A,{onSuccess:this.onSignupSucc,onFailure:this.onSignupFail,OnSitchToLogin:this.switchToStage("LOGIN")}),"DESKTOP"===this.state.currentStage&&r.a.createElement(H,{userId:this.state.userId,onLogout:this.onLogout})))}}]),t}(a.Component);i.a.render(r.a.createElement("div",{className:"main"},r.a.createElement(K,null)),document.getElementById("root")),document.title="Note"}},[[126,1,2]]]);
//# sourceMappingURL=main.d6541227.chunk.js.map